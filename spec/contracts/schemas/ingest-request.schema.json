{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://photochanger.spec/contracts/schemas/ingest-request.schema.json",
  "title": "Ingest Multipart Form",
  "type": "object",
  "description": "Logical representation of the multipart/form-data payload sent to POST /api/ingest/{slot_id}. Each field maps to a part in the multipart request.",
  "properties": {
    "password": {
      "type": "string",
      "minLength": 1,
      "description": "Global ingest password. Must match the hash stored in app_settings.ingest.dslr_password."
    },
    "hash": {
      "type": "string",
      "pattern": "^[0-9a-fA-F]{32,128}$",
      "description": "Hex-encoded checksum (MD5/SHA) of the uploaded image used to verify integrity."
    },
    "fileToUpload": {
      "description": "Binary image payload. The multipart part MUST provide `Content-Type` = image/jpeg | image/png | image/webp. The server validates the header and enforces both the per-slot limit (default ≤ 15 MB) and an absolute 50 MB safety cap.",
      "oneOf": [
        {
          "type": "string",
          "format": "binary",
          "contentMediaType": "image/jpeg"
        },
        {
          "type": "string",
          "format": "binary",
          "contentMediaType": "image/png"
        },
        {
          "type": "string",
          "format": "binary",
          "contentMediaType": "image/webp"
        }
      ]
    }
  },
  "required": [
    "password",
    "hash",
    "fileToUpload"
  ],
  "additionalProperties": {
    "description": "Optional DSLR Remote Pro metadata fields (`time`, `user_id`, `id`, `profile`, `status`, `name`, `model`, `version`, ...). Values are passed through as-is without validation (string, number, boolean, JSON fragments, etc.)."
  },
  "examples": [
    {
      "password": "123456",
      "hash": "7b6c683e1d3fd29c8701791c54e3c12a236f5a5b",
      "fileToUpload": "<binary>",
      "time": "1758217512",
      "profile": "wedding-booth",
      "user_id": "operator-17",
      "id": "CY04N068111304S2L_00000001.",
      "status": "C:\\\\PhotoboothImages\\\\screenSerg\\\\preview.jpg",
      "name": "DESKTOP-K968T3F",
      "model": "Windows",
      "version": "3.30.2"
    }
  ]
}
