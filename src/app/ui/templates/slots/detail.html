{% extends "base.html" %}
{% block title %}Слот {{ slot.id }} — PhotoChanger{% endblock %}
{% block content %}
  <div class="pc-shell">
    <!-- NOTE: представление слота использует моковые данные. -->
    <section class="pc-card pc-grid">
      <div class="pc-grid">
        <a href="{{ url_for('ui:slots-index') }}" class="pc-button" style="width: fit-content;">← Все слоты</a>
        <h1 class="pc-heading" style="font-size: clamp(24px, 3.6vw, 40px);">{{ slot.name }}</h1>
        <div class="pc-muted">
          {{ slot.provider_label }} • {{ slot.operation_label }} • Последнее обновление {{ slot.updated_at.strftime('%d.%m.%Y %H:%M') }}
        </div>
      </div>
      <div class="pc-card" style="padding: var(--pc-gap);">
        <p class="pc-muted" style="margin-top: 0;">Ingest URL:</p>
        <code style="font-size: 14px;">{{ slot.ingest_url }}</code>
        <p class="pc-muted">Пароль выдаётся в настройках. Кнопки будут активированы после интеграции с API.</p>
        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 16px;">
          <button class="pc-button" type="button" disabled>Скопировать URL</button>
          <button class="pc-button" type="button" disabled>Изменить настройки</button>
        </div>
      </div>
      <section class="pc-grid" aria-label="Последние результаты">
        <h2 style="margin: 0; font-size: 22px;">Недавние результаты</h2>
        <div class="pc-grid -results">
          {% for result in recent_results %}
            <article class="pc-card" style="padding: var(--pc-gap);">
              <img
                alt="Превью результата {{ result.job_id }}"
                src="{{ result.thumbnail_url }}"
                class="pc-gallery-thumb"
                loading="lazy"
              />
              <div class="pc-muted" style="display: grid; gap: 4px;">
                <strong style="color: var(--pc-text); font-size: 14px;">Job {{ result.job_id }}</strong>
                <span>Готово: {{ result.completed_at.strftime('%d.%m.%Y %H:%M') if result.completed_at else '—' }}</span>
                <span>Доступно до {{ result.result_expires_at.strftime('%d.%m.%Y %H:%M') if result.result_expires_at else '—' }}</span>
              </div>
              <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                <a class="pc-button{% if result.is_expired %} is-disabled{% endif %}" href="{{ result.download_url }}">Скачать</a>
              </div>
            </article>
          {% else %}
            <div class="pc-empty-state">Пока нет завершённых задач.</div>
          {% endfor %}
        </div>
      </section>
    </section>
  </div>
{% endblock %}
