{% extends "base.html" %}
{% block title %}Статистика — PhotoChanger{% endblock %}
{% block content %}
  <div class="pc-shell">
    <!-- NOTE: сводка строится на моковых значениях, пока API не подключено. -->
    <section class="pc-card pc-grid">
      <h1 class="pc-heading">Сводная статистика</h1>
      <p class="pc-muted">
        Данные будут получены из StatsService на следующих фазах. Сейчас отображаются фиксированные значения для прототипа.
      </p>
      <div class="pc-grid -auto-fit">
        <div class="pc-card" style="padding: var(--pc-gap);">
          <p class="pc-muted" style="margin: 0;">Всего запусков</p>
          <strong style="font-size: 28px;">{{ summary.total_runs }}</strong>
        </div>
        <div class="pc-card" style="padding: var(--pc-gap);">
          <p class="pc-muted" style="margin: 0;">Успешных</p>
          <strong style="font-size: 28px;">{{ summary.successful_runs }}</strong>
        </div>
        <div class="pc-card" style="padding: var(--pc-gap);">
          <p class="pc-muted" style="margin: 0;">Таймауты</p>
          <strong style="font-size: 28px;">{{ summary.timeouts }}</strong>
        </div>
        <div class="pc-card" style="padding: var(--pc-gap);">
          <p class="pc-muted" style="margin: 0;">Ошибки провайдеров</p>
          <strong style="font-size: 28px;">{{ summary.provider_errors }}</strong>
        </div>
      </div>
      <section class="pc-card" style="padding: var(--pc-gap);">
        <h2 style="margin: 0 0 12px 0; font-size: 22px;">Динамика по дням</h2>
        <table>
          <thead>
            <tr>
              <th scope="col">Период</th>
              <th scope="col">Успешные</th>
              <th scope="col">Таймауты</th>
              <th scope="col">Ошибки провайдера</th>
              <th scope="col">Отмены</th>
              <th scope="col">Ошибки иное</th>
            </tr>
          </thead>
          <tbody>
            {% for point in metrics %}
              <tr>
                <td>{{ point.period_start.strftime('%d.%m.%Y') }} → {{ point.period_end.strftime('%d.%m.%Y') }}</td>
                <td>{{ point.success }}</td>
                <td>{{ point.timeouts }}</td>
                <td>{{ point.provider_errors }}</td>
                <td>{{ point.cancelled }}</td>
                <td>{{ point.errors }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>
    </section>
  </div>
{% endblock %}
